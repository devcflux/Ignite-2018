{"$schema":"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"logicAppName":{"type":"String","metadata":{"description":"Name of the logic app."}},"logicAppLocation":{"defaultValue":"[resourceGroup().location]","allowedValues":["eastasia","southeastasia","centralus","eastus","eastus2","westus","northcentralus","southcentralus","northeurope","westeurope","japanwest","japaneast","brazilsouth","australiaeast","australiasoutheast","southindia","centralindia","westindia","canadacentral","canadaeast","westcentralus","westus2","[resourceGroup().location]"],"type":"String","metadata":{"description":"Location of the logic app."}},"sharepointonline_Connection_Name":{"defaultValue":"sharepointonline","type":"String","metadata":{"description":"Name of the connection."}},"approvals_Connection_Name":{"defaultValue":"approvals","type":"String","metadata":{"description":"Name of the connection."}},"azureautomation_Connection_Name":{"defaultValue":"azureautomation","type":"String","metadata":{"description":"Name of the connection."}},"sharepointonline_1_Connection_Name":{"defaultValue":"sharepointonline_1","type":"String","metadata":{"description":"Name of the connection."}},"office365_1_Connection_Name":{"defaultValue":"office365_1","type":"String","metadata":{"description":"Name of the connection."}},"office365_Connection_Name":{"defaultValue":"office365","type":"String","metadata":{"description":"Name of the connection."}}},"resources":[{"type":"Microsoft.Logic/workflows","name":"[parameters('logicAppName')]","apiVersion":"2016-06-01","location":"[parameters('logicAppLocation')]","properties":{"state":"Disabled","definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","contentVersion":"1.0.0.0","parameters":{"$connections":{"defaultValue":{},"type":"Object"},"$authentication":{"defaultValue":{},"type":"SecureObject"},"sharepoint.site":{"defaultValue":"","type":"String"},"sharepoint.list":{"defaultValue":"","type":"String"}},"triggers":{"When_a_new_item_is_created":{"recurrence":{"interval":5,"frequency":"Minute"},"splitOn":"@triggerBody()?.value","metadata":{"flowSystemMetadata":{"swaggerOperationId":"GetOnNewItems"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"get","path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/onnewitems","authentication":"@parameters('$authentication')"},"conditions":[]}},"actions":{"Remove_Spaces_in_Site_Title_for_URL":{"runAfter":{},"type":"InitializeVariable","inputs":{"variables":[{"name":"SiteURL","type":"String","value":"@{replace(triggerBody()?['Title'],' ','')}"}]}},"Check_Site_Type":{"runAfter":{"Initialize_variable":["Succeeded"]},"cases":{"Comms":{"case":"Communication","actions":{"Get_items":{"runAfter":{"Update_Status_Comm":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"GetItems"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"get","path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('072045e3-4f0e-4c7e-8368-3113ccfe3aac'))}/items","authentication":"@parameters('$authentication')"}},"Update_Status_Comm":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PatchItem"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"patch","body":{"Title":"@triggerBody()?['Title']","Status":{"Value":"Pending Approval"}},"path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/items/@{encodeURIComponent(triggerBody()?['ID'])}","queries":{"view":"aa466320-719d-41dc-913f-1660be41c8b3"},"authentication":"@parameters('$authentication')"}},"Condition_4":{"actions":{"Apply_to_each":{"foreach":"@body('Get_items')?['value']","actions":{"Start_an_approval":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"approvalSubscribeV2"}},"type":"ApiConnectionWebhook","inputs":{"host":{"connection":{"name":"@parameters('$connections')['approvals']['connectionId']"}},"body":{"notificationUrl":"@{listCallbackUrl()}","title":"New Communication Site Approval","assignedTo":"drew@globomantics.org;","requestor":"@{triggerBody()?['Author']?['Email']};","details":"Please review and approve this communication site that will be used for all company.","itemLink":"@triggerBody()?['{Link}']","itemLinkDescription":"Link to communication site"},"path":"/types/@{encodeURIComponent('Basic')}/$subscriptions","authentication":"@parameters('$authentication')"}},"Condition_5":{"actions":{"Create_Comm_Site_All_Company":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"CreateJob"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['azureautomation']['connectionId']"}},"method":"put","body":{"properties":{"parameters":{"siteUrl":"@variables('SiteURL')","siteowner":"@triggerBody()?['SiteOwner']?['Email']","sitetitle":"@triggerBody()?['Title']","sitetype":"@triggerBody()?['SiteType']?['Value']","sitealias":"@variables('SiteURL')","sitedetails":"AllCompany"}}},"path":"/subscriptions/@{encodeURIComponent('0ba03e85-6774-4a96-8604-9e0fdb3d898a')}/resourceGroups/@{encodeURIComponent('RG-SPProv')}/providers/Microsoft.Automation/automationAccounts/@{encodeURIComponent('SPProvisioningAutomation')}/jobs","queries":{"x-ms-api-version":"2015-10-31","runbookName":"SPProvisioningAutomationRB","wait":true},"authentication":"@parameters('$authentication')"}},"Update_item":{"runAfter":{"Create_Comm_Site_All_Company":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PatchItem"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline_1']['connectionId']"}},"method":"patch","body":{"Title":"@triggerBody()?['Title']","Status":{"Value":"Completed"},"Url":"@variables('FullSiteUrl')","Logging":"@{body('Create_Comm_Site_All_Company')?['properties']?['provisioningState']} - @{body('Create_Comm_Site_All_Company')?['properties']?['status']} - @{body('Create_Comm_Site_All_Company')?['properties']?['statusDetails']}"},"path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/items/@{encodeURIComponent(triggerBody()?['ID'])}","authentication":"@parameters('$authentication')"}},"Send_email_comm_all_company":{"runAfter":{"Update_item":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365_1']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Site Request Completed: @{body('Update_item')['Title']}","Body":"Your new site request is completed and you can view the site at @{variables('FullSiteUrl')}","Cc":"@{body('Update_item')?['SiteOwner']?['Email']};@{body('Update_item')?['SecondaryOwner']?['Email']};"},"path":"/Mail","authentication":"@parameters('$authentication')"}}},"runAfter":{"Start_an_approval":["Succeeded"]},"else":{"actions":{"Apply_to_each_2":{"foreach":"@body('Start_an_approval')?['responses']","actions":{"Send_an_email":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Your communication site request was denied","Body":"Your communication site request was denied\n\nApprover comments: @{items('Apply_to_each_2')?['comments']}\n\n@{triggerBody()?['{Link}']}"},"path":"/Mail","authentication":"@parameters('$authentication')"}}},"runAfter":{},"type":"Foreach"}}},"expression":"@equals(body('Start_an_approval')?['response'], 'Approve')","type":"If"}},"runAfter":{},"type":"Foreach"}},"runAfter":{"Get_items":["Succeeded"]},"else":{"actions":{"Apply_to_each_3":{"foreach":"@body('Get_items')?['value']","actions":{"Create_Comm_Site":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"CreateJob"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['azureautomation']['connectionId']"}},"method":"put","body":{"properties":{"parameters":{"siteUrl":"@variables('SiteURL')","siteowner":"@triggerBody()?['SiteOwner']?['Email']","sitetitle":"@triggerBody()?['Title']","sitetype":"@triggerBody()?['SiteType']?['Value']","sitealias":"@variables('SiteURL')"}}},"path":"/subscriptions/@{encodeURIComponent('0ba03e85-6774-4a96-8604-9e0fdb3d898a')}/resourceGroups/@{encodeURIComponent('RG-SPProv')}/providers/Microsoft.Automation/automationAccounts/@{encodeURIComponent('SPProvisioningAutomation')}/jobs","queries":{"x-ms-api-version":"2015-10-31","runbookName":"SPProvisioningAutomationRB","wait":true},"authentication":"@parameters('$authentication')"}},"Condition":{"actions":{"Update_comm_non_all_company":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PatchItem"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"patch","body":{"Title":"@triggerBody()?['Title']","Status":{"Value":"Completed"},"Url":"@variables('FullSiteUrl')","Logging":"@{body('Create_Comm_Site')?['properties']?['provisioningState']}  - @{body('Create_Comm_Site')?['properties']?['status']} - @{body('Create_Comm_Site')?['properties']?['statusDetails']}"},"path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/items/@{encodeURIComponent(triggerBody()?['ID'])}","queries":{"view":"aa466320-719d-41dc-913f-1660be41c8b3"},"authentication":"@parameters('$authentication')"}},"Send_email_comm_non_all_company":{"runAfter":{"Update_comm_non_all_company":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Site Request Completed: @{triggerBody()?['Title']}","Body":"Your new site request is completed and you can view the site at @{variables('FullSiteUrl')}"},"path":"/Mail","authentication":"@parameters('$authentication')"}}},"runAfter":{"Create_Comm_Site":["Succeeded"]},"else":{"actions":{"Send_email_comm_non_all_company_fail":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Your site creation failed ","Body":"Your site creation failed and someone will be in touch with you shortly"},"path":"/Mail","authentication":"@parameters('$authentication')"}}}},"expression":"@not(equals(body('Create_Comm_Site')?['properties']?['status'], 'Succeeded'))","type":"If"}},"runAfter":{},"type":"Foreach"}}},"expression":"@equals(triggerBody()?['CommunicationAllCompany']?['Value'], 'Yes')","type":"If"}}},"PM":{"case":"Project Management","actions":{"Start_an_approval_2":{"runAfter":{"Update_item_2":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"approvalSubscribeV2"}},"type":"ApiConnectionWebhook","inputs":{"host":{"connection":{"name":"@parameters('$connections')['approvals']['connectionId']"}},"body":{"notificationUrl":"@{listCallbackUrl()}","title":"New Project Site Approval","assignedTo":"@{triggerBody()?['ProjectSponsor']?['Email']};","requestor":"@{triggerBody()?['Author']?['Email']};","details":"Please review the requested Project Site to be created","itemLink":"@triggerBody()?['{Link}']","itemLinkDescription":"A new project site is being requested."},"path":"/types/@{encodeURIComponent('Basic')}/$subscriptions","authentication":"@parameters('$authentication')"}},"Condition_3":{"actions":{"Create_job":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"CreateJob"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['azureautomation']['connectionId']"}},"method":"put","body":{"properties":{"parameters":{"siteUrl":"@variables('SiteURL')","siteowner":"@triggerBody()?['SiteOwner']?['Email']","sitetitle":"@triggerBody()?['Title']","sitetype":"@triggerBody()?['SiteType']?['Value']","sitealias":"@variables('SiteURL')"}}},"path":"/subscriptions/@{encodeURIComponent('0ba03e85-6774-4a96-8604-9e0fdb3d898a')}/resourceGroups/@{encodeURIComponent('RG-SPProv')}/providers/Microsoft.Automation/automationAccounts/@{encodeURIComponent('SPProvisioningAutomation')}/jobs","queries":{"x-ms-api-version":"2015-10-31","runbookName":"SPProvisioningAutomationRB","wait":true},"authentication":"@parameters('$authentication')"}},"Condition_2":{"actions":{"Update_Status_PM":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PatchItem"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"patch","body":{"Title":"@triggerBody()?['Title']","Status":{"Value":"Completed"},"Url":"@variables('FullSiteUrl')","Logging":"@{body('Create_job')?['properties']?['provisioningState']}   @{body('Create_job')?['properties']?['status']}  @{body('Create_job')?['properties']?['statusDetails']}"},"path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/items/@{encodeURIComponent(triggerBody()?['ID'])}","queries":{"view":"aa466320-719d-41dc-913f-1660be41c8b3"},"authentication":"@parameters('$authentication')"}},"Send_an_email_2":{"runAfter":{"Update_Status_PM":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Your new site has been created!","Body":"You can now access your new site - @{variables('FullSiteUrl')}"},"path":"/Mail","authentication":"@parameters('$authentication')"}}},"runAfter":{"Create_job":["Succeeded"]},"else":{"actions":{"Send_an_email_3":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"There was an issue with your site creation","Body":"There was an issue with your site creation - someone will be in touch shortly to help you resolve the issue. "},"path":"/Mail","authentication":"@parameters('$authentication')"}}}},"expression":"@not(equals(body('Create_job')?['properties']?['status'], 'Succeeded'))","type":"If"}},"runAfter":{"Start_an_approval_2":["Succeeded"]},"else":{"actions":{"Send_an_email_4":{"runAfter":{"Update_pm_site_denied":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Your site creation request was denied","Body":"Your site creation created was denied - please review and submit again.\n\nApproval comments: @{body('Start_an_approval_2')?['comments']}\n\n@{triggerBody()?['{Link}']}"},"path":"/Mail","authentication":"@parameters('$authentication')"}},"Update_pm_site_denied":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PatchItem"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"patch","body":{"Title":"@triggerBody()?['Title']","Status":{"Value":"Approval Denied"}},"path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/items/@{encodeURIComponent(triggerBody()?['ID'])}","queries":{"view":"aa466320-719d-41dc-913f-1660be41c8b3"},"authentication":"@parameters('$authentication')"}}}},"expression":"@equals(body('Start_an_approval_2')?['response'], 'Approve')","type":"If"},"Update_item_2":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PatchItem"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"patch","body":{"Title":"@triggerBody()?['Title']","Status":{"Value":"Pending Approval"}},"path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/items/@{encodeURIComponent(triggerBody()?['ID'])}","queries":{"view":"aa466320-719d-41dc-913f-1660be41c8b3"},"authentication":"@parameters('$authentication')"}}}},"Case":{"case":"Document Repository","actions":{"Create_doc_rep":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"CreateJob"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['azureautomation']['connectionId']"}},"method":"put","body":{"properties":{"parameters":{"siteUrl":"@variables('SiteURL')","siteowner":"@triggerBody()?['SiteOwner']?['Email']","sitetitle":"@triggerBody()?['Title']","sitetype":"@triggerBody()?['SiteType']?['Value']","sitealias":"@variables('SiteURL')","sitedetails":"null"}}},"path":"/subscriptions/@{encodeURIComponent('0ba03e85-6774-4a96-8604-9e0fdb3d898a')}/resourceGroups/@{encodeURIComponent('RG-SPProv')}/providers/Microsoft.Automation/automationAccounts/@{encodeURIComponent('SPProvisioningAutomation')}/jobs","queries":{"x-ms-api-version":"2015-10-31","runbookName":"SPProvisioningAutomationRB","wait":true},"authentication":"@parameters('$authentication')"}},"If_doc_rep_succeds":{"actions":{"Send_email_doc_rep_confirmed":{"runAfter":{"Update_doc_rec_success":["Succeeded"]},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Your new site has been created!","Body":"You can now access your new site - @{variables('FullSiteUrl')}"},"path":"/Mail","authentication":"@parameters('$authentication')"}},"Update_doc_rec_success":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"PatchItem"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['sharepointonline']['connectionId']"}},"method":"patch","body":{"Title":"@triggerBody()?['Title']","Status":{"Value":"Completed"},"Url":"@variables('FullSiteUrl')","Logging":"@{body('Create_doc_rep')?['properties']?['provisioningState']} - @{body('Create_doc_rep')?['properties']?['status']} - @{body('Create_doc_rep')?['properties']?['statusDetails']}"},"path":"/datasets/@{encodeURIComponent(encodeURIComponent('https://globomanticsorg.sharepoint.com/sites/SiteAdministration'))}/tables/@{encodeURIComponent(encodeURIComponent('400e657d-49dc-4ec0-adb4-9baab1dc4961'))}/items/@{encodeURIComponent(triggerBody()?['ID'])}","queries":{"view":"aa466320-719d-41dc-913f-1660be41c8b3"},"authentication":"@parameters('$authentication')"}}},"runAfter":{"Create_doc_rep":["Succeeded"]},"else":{"actions":{"Send_email_doc_rep_fail":{"runAfter":{},"metadata":{"flowSystemMetadata":{"swaggerOperationId":"SendEmail"}},"type":"ApiConnection","inputs":{"host":{"connection":{"name":"@parameters('$connections')['office365']['connectionId']"}},"method":"post","body":{"To":"@{triggerBody()?['Author']?['Email']};","Subject":"Your document repository site creation failed","Body":"Someone will be in touch with you shortly "},"path":"/Mail","authentication":"@parameters('$authentication')"}}}},"expression":"@not(equals(body('Create_doc_rep')?['properties']?['status'], 'Succeeded'))","type":"If"}}}},"default":{"actions":{}},"expression":"@triggerBody()?['SiteType']?['Value']","type":"Switch"},"Initialize_variable":{"runAfter":{"Remove_Spaces_in_Site_Title_for_URL":["Succeeded"]},"type":"InitializeVariable","inputs":{"variables":[{"name":"FullSiteUrl","type":"String","value":"@{concat('https://globomanticsorg.sharepoint.com/sites/',variables('SiteUrl'))}"}]}}},"description":"Create a custom action to happen when a new item is added to SharePoint. It could be sending an email, copying the item to a folder or web service, or more�you decide."},"parameters":{"$connections":{"value":{"sharepointonline":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'sharepointonline')]","connectionId":"[resourceId('Microsoft.Web/connections', parameters('sharepointonline_Connection_Name'))]","connectionName":"[parameters('sharepointonline_Connection_Name')]"},"approvals":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'approvals')]","connectionId":"[resourceId('Microsoft.Web/connections', parameters('approvals_Connection_Name'))]","connectionName":"[parameters('approvals_Connection_Name')]"},"azureautomation":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'azureautomation')]","connectionId":"[resourceId('Microsoft.Web/connections', parameters('azureautomation_Connection_Name'))]","connectionName":"[parameters('azureautomation_Connection_Name')]"},"sharepointonline_1":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'sharepointonline_1')]","connectionId":"[resourceId('Microsoft.Web/connections', parameters('sharepointonline_1_Connection_Name'))]","connectionName":"[parameters('sharepointonline_1_Connection_Name')]"},"office365_1":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'office365_1')]","connectionId":"[resourceId('Microsoft.Web/connections', parameters('office365_1_Connection_Name'))]","connectionName":"[parameters('office365_1_Connection_Name')]"},"office365":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'office365')]","connectionId":"[resourceId('Microsoft.Web/connections', parameters('office365_Connection_Name'))]","connectionName":"[parameters('office365_Connection_Name')]"}}}},"runtimeConfiguration":{"collections":{"maximumItemCount":5000},"performanceProfile":{"throttles":{"mode":"Low"}}}},"dependsOn":["[resourceId('Microsoft.Web/connections', parameters('sharepointonline_Connection_Name'))]","[resourceId('Microsoft.Web/connections', parameters('approvals_Connection_Name'))]","[resourceId('Microsoft.Web/connections', parameters('azureautomation_Connection_Name'))]","[resourceId('Microsoft.Web/connections', parameters('sharepointonline_1_Connection_Name'))]","[resourceId('Microsoft.Web/connections', parameters('office365_1_Connection_Name'))]","[resourceId('Microsoft.Web/connections', parameters('office365_Connection_Name'))]"]},{"type":"Microsoft.Web/connections","name":"[parameters('sharepointonline_Connection_Name')]","apiVersion":"2016-06-01","location":"[parameters('logicAppLocation')]","properties":{"api":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'sharepointonline')]"},"displayName":"[parameters('sharepointonline_Connection_Name')]"}},{"type":"Microsoft.Web/connections","name":"[parameters('approvals_Connection_Name')]","apiVersion":"2016-06-01","location":"[parameters('logicAppLocation')]","properties":{"api":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'approvals')]"},"displayName":"[parameters('approvals_Connection_Name')]"}},{"type":"Microsoft.Web/connections","name":"[parameters('azureautomation_Connection_Name')]","apiVersion":"2016-06-01","location":"[parameters('logicAppLocation')]","properties":{"api":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'azureautomation')]"},"displayName":"[parameters('azureautomation_Connection_Name')]"}},{"type":"Microsoft.Web/connections","name":"[parameters('sharepointonline_1_Connection_Name')]","apiVersion":"2016-06-01","location":"[parameters('logicAppLocation')]","properties":{"api":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'sharepointonline_1')]"},"displayName":"[parameters('sharepointonline_1_Connection_Name')]"}},{"type":"Microsoft.Web/connections","name":"[parameters('office365_1_Connection_Name')]","apiVersion":"2016-06-01","location":"[parameters('logicAppLocation')]","properties":{"api":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'office365_1')]"},"displayName":"[parameters('office365_1_Connection_Name')]"}},{"type":"Microsoft.Web/connections","name":"[parameters('office365_Connection_Name')]","apiVersion":"2016-06-01","location":"[parameters('logicAppLocation')]","properties":{"api":{"id":"[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('logicAppLocation'), '/managedApis/', 'office365')]"},"displayName":"[parameters('office365_Connection_Name')]"}}]}